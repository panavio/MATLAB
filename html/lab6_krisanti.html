<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Laplace Transform Lab: Solving ODEs using Laplace Transform in MATLAB</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2023-12-04">
<meta name="DC.source" content="lab6_krisanti.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Laplace Transform Lab: Solving ODEs using Laplace Transform in MATLAB</h1>
<!--introduction-->
<p>This lab will teach you to solve ODEs using a built in MATLAB Laplace transform function <tt>laplace</tt>.</p>
<p>There are five (5) exercises in this lab that are to be handed in. Write your solutions in a separate file, including appropriate descriptions in each step.</p>
<p>Include your name and student number in the submitted file.</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Student Information</a>
</li>
<li>
<a href="#4">Using symbolic variables to define functions</a>
</li>
<li>
<a href="#5">Laplace transform and its inverse</a>
</li>
<li>
<a href="#13">Exercise 1</a>
</li>
<li>
<a href="#14">Heaviside and Dirac functions</a>
</li>
<li>
<a href="#15">Exercise 2</a>
</li>
<li>
<a href="#18">Solving IVPs using Laplace transforms</a>
</li>
<li>
<a href="#19">Exercise 3</a>
</li>
<li>
<a href="#21">Exercise 4</a>
</li>
<li>
<a href="#24">Exercise 5</a>
</li>
</ul>
</div>
<h2 id="1">Student Information</h2>
<pre>Student Name: Patricia Nadia Krisanti</pre>
<pre>Student Number: 1009669404</pre>
<h2 id="4">Using symbolic variables to define functions</h2>
<p>In this exercise we will use symbolic variables and functions.</p>
<pre class="codeinput">syms <span class="string">t</span> <span class="string">s</span> <span class="string">x</span> <span class="string">y</span>

f = cos(t)
h = exp(2*x)
</pre>
<pre class="codeoutput"> 
f =
 
cos(t)
 
 
h =
 
exp(2*x)
 
</pre>
<h2 id="5">Laplace transform and its inverse</h2>
<pre class="codeinput">
<span class="comment">% The routine |laplace| computes the Laplace transform of a function</span>

F=laplace(f)
</pre>
<pre class="codeoutput"> 
F =
 
s/(s^2 + 1)
 
</pre>
<p>By default it uses the variable <tt>s</tt> for the Laplace transform But we can specify which variable we want:</p>
<pre class="codeinput">H=laplace(h)
laplace(h,y)

<span class="comment">% Observe that the results are identical: one in the variable |s| and the</span>
<span class="comment">% other in the variable |y|</span>
</pre>
<pre class="codeoutput"> 
H =
 
1/(s - 2)
 
 
ans =
 
1/(y - 2)
 
</pre>
<p>We can also specify which variable to use to compute the Laplace transform:</p>
<pre class="codeinput">j = exp(x*t)
laplace(j)
laplace(j,x,s)

<span class="comment">% By default, MATLAB assumes that the Laplace transform is to be computed</span>
<span class="comment">% using the variable |t|, unless we specify that we should use the variable</span>
<span class="comment">% |x|</span>
</pre>
<pre class="codeoutput"> 
j =
 
exp(t*x)
 
 
ans =
 
1/(s - x)
 
 
ans =
 
1/(s - t)
 
</pre>
<p>We can also use inline functions with <tt>laplace</tt>. When using inline functions, we always have to specify the variable of the function.</p>
<pre class="codeinput">l = @(t) t^2+t+1
laplace(l(t))
</pre>
<pre class="codeoutput">
l =

  function_handle with value:

    @(t)t^2+t+1

 
ans =
 
(s + 1)/s^2 + 2/s^3
 
</pre>
<p>MATLAB also has the routine <tt>ilaplace</tt> to compute the inverse Laplace transform</p>
<pre class="codeinput">ilaplace(F)
ilaplace(H)
ilaplace(laplace(f))
</pre>
<pre class="codeoutput"> 
ans =
 
cos(t)
 
 
ans =
 
exp(2*t)
 
 
ans =
 
cos(t)
 
</pre>
<p>If <tt>laplace</tt> cannot compute the Laplace transform, it returns an unevaluated call.</p>
<pre class="codeinput">g = 1/sqrt(t^2+1)
G = laplace(g)
</pre>
<pre class="codeoutput"> 
g =
 
1/(t^2 + 1)^(1/2)
 
 
G =
 
laplace(1/(t^2 + 1)^(1/2), t, s)
 
</pre>
<p>But MATLAB "knows" that it is supposed to be a Laplace transform of a function. So if we compute the inverse Laplace transform, we obtain the original function</p>
<pre class="codeinput">ilaplace(G)
</pre>
<pre class="codeoutput"> 
ans =
 
1/(t^2 + 1)^(1/2)
 
</pre>
<p>The Laplace transform of a function is related to the Laplace transform of its derivative:</p>
<pre class="codeinput">syms <span class="string">g(t)</span>
laplace(diff(g,t),t,s)
</pre>
<pre class="codeoutput"> 
ans =
 
s*laplace(g(t), t, s) - g(0)
 
</pre>
<h2 id="13">Exercise 1</h2>
<p>Objective: Compute the Laplace transform and use it to show that MATLAB 'knows' some of its properties.</p>
<p>Details:</p>
<p>(a) Define the function <tt>f(t)=exp(2t)*t^3</tt>, and compute its Laplace transform <tt>F(s)</tt>. (b) Find a function <tt>f(t)</tt> such that its Laplace transform is  <tt>(s - 1)*(s - 2))/(s*(s + 2)*(s - 3)</tt> (c) Show that MATLAB 'knows' that if <tt>F(s)</tt> is the Laplace transform of  <tt>f(t)</tt>, then the Laplace transform of <tt>exp(at)f(t)</tt> is <tt>F(s-a)</tt>
</p>
<p>(in your answer, explain part (c) using comments).</p>
<p>Observe that MATLAB splits the rational function automatically when solving the inverse Laplace transform.</p>
<pre class="codeinput">
<span class="comment">%a</span>
syms <span class="string">f(t)</span> <span class="string">f2(t)</span>
f(t)=exp(2.*t).*t.^3
F=laplace(f(t))
<span class="comment">%b</span>
f2(t)=((s - 1)*(s - 2))/(s*(s + 2)*(s - 3))
f=ilaplace(f2)

<span class="comment">%c</span>
h = @(t) t^2
H1 = laplace(h(t))
H2 = laplace(exp(3*t) * h(t)) <span class="comment">% is H1 with s shifted by 3 (s-3)</span>
<span class="comment">% it shows that MATLAB knows that the laplace transform of exp(at)f(t) is</span>
<span class="comment">% F(s-a) because it outputs the same value of s in H1 and replace it by</span>
<span class="comment">% (s-3) in H2 when the function is multiplied by exp(3t)</span>
</pre>
<pre class="codeoutput"> 
f(t) =
 
t^3*exp(2*t)
 
 
F =
 
6/(s - 2)^4
 
 
f2(t) =
 
((s - 1)*(s - 2))/(s*(s + 2)*(s - 3))
 
 
f(t) =
 
(6*exp(-2*t))/5 + (2*exp(3*t))/15 - 1/3
 

h =

  function_handle with value:

    @(t)t^2

 
H1 =
 
2/s^3
 
 
H2 =
 
2/(s - 3)^3
 
</pre>
<h2 id="14">Heaviside and Dirac functions</h2>
<p>These two functions are builtin to MATLAB: <tt>heaviside</tt> is the Heaviside function <tt>u_0(t)</tt> at <tt>0</tt>
</p>
<p>To define <tt>u_2(t)</tt>, we need to write</p>
<pre class="codeinput">f=heaviside(t-2)
ezplot(f,[-1,5])

<span class="comment">% The Dirac delta function (at |0|) is also defined with the routine |dirac|</span>

g = dirac(t-3)

<span class="comment">% MATLAB "knows" how to compute the Laplace transform of these functions</span>

laplace(f)
laplace(g)
</pre>
<pre class="codeoutput"> 
f =
 
heaviside(t - 2)
 
 
g =
 
dirac(t - 3)
 
 
ans =
 
exp(-2*s)/s
 
 
ans =
 
exp(-3*s)
 
</pre>
<img vspace="5" hspace="5" src="lab6_krisanti_01.png" alt=""> <h2 id="15">Exercise 2</h2>
<p>Objective: Find a formula comparing the Laplace transform of a translation of <tt>f(t)</tt> by <tt>t-a</tt> with the Laplace transform of <tt>f(t)</tt>
</p>
<p>Details:</p>
<div>
<ul>
<li>Give a value to <tt>a</tt>
</li>
<li>Let <tt>G(s)</tt> be the Laplace transform of <tt>g(t)=u_a(t)f(t-a)</tt> and <tt>F(s)</tt> is the Laplace transform of <tt>f(t)</tt>, then find a formula relating <tt>G(s)</tt> and <tt>F(s)</tt>
</li>
</ul>
</div>
<p>In your answer, explain the 'proof' using comments.</p>
<pre class="codeinput">syms <span class="string">g(t)</span> <span class="string">f(t)</span>
a=5
u_a(t)=heaviside(t)
g(t)=u_a(t-a).*f(t-a)
G=laplace(g)
F=laplace(f)
<span class="comment">%G(s) = exp(-as)*F</span>
<span class="comment">%when shifted by t-a (shift to the right by a), the laplace transform</span>
<span class="comment">%will also shift into the original laplace transform multiplied by exp(-as)</span>
<span class="comment">%this agrees with the property of laplace transform as proven in tutorial</span>
</pre>
<pre class="codeoutput">
a =

     5

 
u_a(t) =
 
heaviside(t)
 
 
g(t) =
 
f(t - 5)*heaviside(t - 5)
 
 
G =
 
exp(-5*s)*laplace(f(t), t, s)
 
 
F =
 
laplace(f(t), t, s)
 
</pre>
<h2 id="18">Solving IVPs using Laplace transforms</h2>
<p>Consider the following IVP, <tt>y''-3y = 5t</tt> with the initial conditions <tt>y(0)=1</tt> and <tt>y'(0)=2</tt>. We can use MATLAB to solve this problem using Laplace transforms:</p>
<pre class="codeinput">
<span class="comment">% First we define the unknown function and its variable and the Laplace</span>
<span class="comment">% transform of the unknown</span>

syms <span class="string">y(t)</span> <span class="string">t</span> <span class="string">Y</span> <span class="string">s</span>

<span class="comment">% Then we define the ODE</span>

ODE=diff(y(t),t,2)-3*y(t)-5*t == 0

<span class="comment">% Now we compute the Laplace transform of the ODE.</span>

L_ODE = laplace(ODE)

<span class="comment">% Use the initial conditions</span>

L_ODE=subs(L_ODE,y(0),1)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),2)

<span class="comment">% We then need to factor out the Laplace transform of |y(t)|</span>

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

<span class="comment">% We now need to use the inverse Laplace transform to obtain the solution</span>
<span class="comment">% to the original IVP</span>

y = ilaplace(Y)

<span class="comment">% We can plot the solution</span>

ezplot(y,[0,20])

<span class="comment">% We can check that this is indeed the solution</span>

diff(y,t,2)-3*y
</pre>
<pre class="codeoutput"> 
ODE =
 
diff(y(t), t, t) - 3*y(t) - 5*t == 0
 
 
L_ODE =
 
s^2*laplace(y(t), t, s) - subs(diff(y(t), t), t, 0) - s*y(0) - 5/s^2 - 3*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
s^2*laplace(y(t), t, s) - subs(diff(y(t), t), t, 0) - s - 5/s^2 - 3*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
s^2*laplace(y(t), t, s) - s - 5/s^2 - 3*laplace(y(t), t, s) - 2 == 0
 
 
L_ODE =
 
Y*s^2 - s - 3*Y - 5/s^2 - 2 == 0
 
 
Y =
 
(s + 5/s^2 + 2)/(s^2 - 3)
 
 
y =
 
cosh(3^(1/2)*t) - (5*t)/3 + (11*3^(1/2)*sinh(3^(1/2)*t))/9
 
 
ans =
 
5*t
 
</pre>
<img vspace="5" hspace="5" src="lab6_krisanti_02.png" alt=""> <h2 id="19">Exercise 3</h2>
<p>Objective: Solve an IVP using the Laplace transform</p>
<p>Details: Explain your steps using comments</p>
<div>
<ul>
<li>Solve the IVP</li>
<li>
<tt>y'''+2y''+y'+2*y=-cos(t)</tt>
</li>
<li>
<tt>y(0)=0</tt>, <tt>y'(0)=0</tt>, and <tt>y''(0)=0</tt>
</li>
<li>for <tt>t</tt> in <tt>[0,10*pi]</tt>
</li>
<li>Is there an initial condition for which <tt>y</tt> remains bounded as <tt>t</tt> goes to infinity? If so, find it.</li>
</ul>
</div>
<pre class="codeinput">syms <span class="string">y(t)</span> <span class="string">t</span> <span class="string">Y</span> <span class="string">s</span>
<span class="comment">% Then we define the ODE</span>

ODE=diff(y(t),t,3)+2*diff(y(t),t,2)+diff(y(t),t,1)+2*y(t)+cos(t) == 0
<span class="comment">%y'''+2y''+y'+2*y=-cos(t)</span>

<span class="comment">% Now we compute the Laplace transform of the ODE.</span>

L_ODE = laplace(ODE)

<span class="comment">% Use the initial conditions</span>

L_ODE=subs(L_ODE,y(0),0)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),0)
L_ODE=subs(L_ODE,subs(diff(y(t), t, 2), t, 0),0)

<span class="comment">% We then need to factor out the Laplace transform of |y(t)|</span>

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

<span class="comment">% We now need to use the inverse Laplace transform to obtain the solution</span>
<span class="comment">% to the original IVP</span>

y = ilaplace(Y)

<span class="comment">% We can plot the solution</span>

ezplot(y,[0,10*pi])


<span class="comment">% Using arbitrary constants a, b, and c we can find the general</span>
<span class="comment">% solution of the ODE</span>
<span class="comment">% a*exp(-2t) +bcos(t)+c*sin(t)-t*sin(t)/5+t*cos(t)/10</span>
<span class="comment">% There's no initial condition for which y remains bounded as t goes to</span>
<span class="comment">% infinity since when t approaches infinity y will continue growing while oscillating</span>
<span class="comment">% -a*exp(-2t) will approach 0</span>
<span class="comment">% bcos(t) will oscillate will oscillate between b and -b</span>
<span class="comment">% c*sin(t) will oscillate between c and -c</span>
<span class="comment">% which means the final solution will oscillate</span>
<span class="comment">% - t*sin(t)/5 + t*cos(t)/10 will diverge, this does not depend on</span>
<span class="comment">% constants a, b, and c or the initial conditions</span>
<span class="comment">% thus the final solution will oscillate while diverge, or in other words</span>
<span class="comment">% growing while oscillating no matter the initial conditions</span>
</pre>
<pre class="codeoutput"> 
ODE =
 
cos(t) + 2*y(t) + diff(y(t), t) + 2*diff(y(t), t, t) + diff(y(t), t, t, t) == 0
 
 
L_ODE =
 
s*laplace(y(t), t, s) - y(0) - s*subs(diff(y(t), t), t, 0) - 2*s*y(0) - 2*subs(diff(y(t), t), t, 0) + s/(s^2 + 1) + 2*s^2*laplace(y(t), t, s) + s^3*laplace(y(t), t, s) - s^2*y(0) - subs(diff(y(t), t, t), t, 0) + 2*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
s*laplace(y(t), t, s) - s*subs(diff(y(t), t), t, 0) - 2*subs(diff(y(t), t), t, 0) + s/(s^2 + 1) + 2*s^2*laplace(y(t), t, s) + s^3*laplace(y(t), t, s) - subs(diff(y(t), t, t), t, 0) + 2*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
s*laplace(y(t), t, s) + s/(s^2 + 1) + 2*s^2*laplace(y(t), t, s) + s^3*laplace(y(t), t, s) - subs(diff(y(t), t, t), t, 0) + 2*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
s*laplace(y(t), t, s) + s/(s^2 + 1) + 2*s^2*laplace(y(t), t, s) + s^3*laplace(y(t), t, s) + 2*laplace(y(t), t, s) == 0
 
 
L_ODE =
 
2*Y + Y*s + s/(s^2 + 1) + 2*Y*s^2 + Y*s^3 == 0
 
 
Y =
 
-s/((s^2 + 1)*(s^3 + 2*s^2 + s + 2))
 
 
y =
 
(2*exp(-2*t))/25 - (2*cos(t))/25 + (3*sin(t))/50 + (t*cos(t))/10 - (t*sin(t))/5
 
</pre>
<img vspace="5" hspace="5" src="lab6_krisanti_03.png" alt=""> <h2 id="21">Exercise 4</h2>
<p>Objective: Solve an IVP using the Laplace transform</p>
<p>Details:</p>
<div>
<ul>
<li>Define</li>
<li>
<tt>g(t) = 3 if 0 &lt; t &lt; 2</tt>
</li>
<li>
<tt>g(t) = t+1 if 2 &lt; t &lt; 5</tt>
</li>
<li>
<tt>g(t) = 5 if t &gt; 5</tt>
</li>
<li>Solve the IVP</li>
<li>
<tt>y''+2y'+5y=g(t)</tt>
</li>
<li>
<tt>y(0)=2 and y'(0)=1</tt>
</li>
<li>Plot the solution for <tt>t</tt> in <tt>[0,12]</tt> and <tt>y</tt> in <tt>[0,2.25]</tt>.</li>
</ul>
</div>
<p>In your answer, explain your steps using comments.</p>
<pre class="codeinput">
<span class="comment">% First we define the unknown function and its variable and the Laplace</span>
<span class="comment">% transform of the unknown</span>

syms <span class="string">y(t)</span> <span class="string">t</span> <span class="string">Y</span> <span class="string">s</span> <span class="string">g(t)</span>
<span class="comment">%g(t) = piecewise(0 &lt; t &lt; 2, 3 , 2 &lt; t &lt; 5, t+1, t &gt; 5, 5)</span>
<span class="comment">%g(t) = (3).*[heaviside(t)-heaviside(t-2)]+(t+1).*[heaviside(t-2)-heaviside(t-5)]+(5).*[heaviside(t-5)];</span>
g(t) = (3).*(heaviside(t))+(t-2).*heaviside(t+3).*(heaviside(t-5));
<span class="comment">%plot(t,y)</span>
<span class="comment">% Then we define the ODE</span>

ODE=diff(y(t),t,2)+2.*diff(y(t),t) + 5*y(t) == g(t)

<span class="comment">% Now we compute the Laplace transform of the ODE.</span>

L_ODE = laplace(ODE)

<span class="comment">% Use the initial conditions</span>

L_ODE=subs(L_ODE,y(0),2)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),1)

<span class="comment">% We then need to factor out the Laplace transform of |y(t)|</span>

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

<span class="comment">% We now need to use the inverse Laplace transform to obtain the solution</span>
<span class="comment">% to the original IVP</span>

y = ilaplace(Y)

<span class="comment">% We can plot the solution</span>

ezplot(y,[0, 12, 0, 2.25])
clear
</pre>
<pre class="codeoutput"> 
ODE =
 
5*y(t) + 2*diff(y(t), t) + diff(y(t), t, t) == 3*heaviside(t) + heaviside(t + 3)*heaviside(t - 5)*(t - 2)
 
 
L_ODE =
 
2*s*laplace(y(t), t, s) - 2*y(0) - s*y(0) - subs(diff(y(t), t), t, 0) + s^2*laplace(y(t), t, s) + 5*laplace(y(t), t, s) == 3/s + (exp(-5*s)*(3*s + 1))/s^2
 
 
L_ODE =
 
2*s*laplace(y(t), t, s) - 2*s - subs(diff(y(t), t), t, 0) + s^2*laplace(y(t), t, s) + 5*laplace(y(t), t, s) - 4 == 3/s + (exp(-5*s)*(3*s + 1))/s^2
 
 
L_ODE =
 
2*s*laplace(y(t), t, s) - 2*s + s^2*laplace(y(t), t, s) + 5*laplace(y(t), t, s) - 5 == 3/s + (exp(-5*s)*(3*s + 1))/s^2
 
 
L_ODE =
 
5*Y - 2*s + 2*Y*s + Y*s^2 - 5 == 3/s + (exp(-5*s)*(3*s + 1))/s^2
 
 
Y =
 
(2*s + 3/s + (exp(-5*s)*(3*s + 1))/s^2 + 5)/(s^2 + 2*s + 5)
 
 
y =
 
heaviside(t - 5)*(t/5 + (2*exp(5 - t)*(cos(2*t - 10) - (3*sin(2*t - 10))/4))/25 - 27/25) + 2*exp(-t)*(cos(2*t) - sin(2*t)/2) - (3*exp(-t)*(cos(2*t) + sin(2*t)/2))/5 + (5*sin(2*t)*exp(-t))/2 - 3*heaviside(t - 5)*((exp(5 - t)*(cos(2*t - 10) + sin(2*t - 10)/2))/5 - 1/5) + 3/5
 
</pre>
<img vspace="5" hspace="5" src="lab6_krisanti_04.png" alt=""> <h2 id="24">Exercise 5</h2>
<p>Objective: Use the Laplace transform to solve an integral equation</p>
<p>Verify that MATLAB knowns about the convolution theorem by explaining why the following transform is computed correctly.</p>
<pre class="codeinput">syms <span class="string">t</span> <span class="string">tau</span> <span class="string">y(tau)</span> <span class="string">s</span>
I=int(exp(-2*(t-tau))*y(tau),tau,0,t) <span class="comment">%f(t-Tau) = exp(-2*(t-tau)) , g(tau)=y(tau)</span>
L= laplace(I,t,s)
L= laplace(int(exp(-2*(tau))*y(t-tau),tau,0,t),t,s) <span class="comment">%H</span>

G=laplace(y(t), t, s)
F=laplace(exp(-2*(t)), t, s)
H=F*G
<span class="comment">% as shown by the answer, the solution to the laplace of the integral of</span>
<span class="comment">% f(t-tau)g(tau) dtau is equivalent to the laplace of f(t) * laplace of g(t)</span>
<span class="comment">% which satisfies the convolution theorem that states that Laplace transform of a convolution integral is equal</span>
<span class="comment">% to the product of the individual Laplace transforms of the functions involved.</span>
</pre>
<pre class="codeoutput"> 
I =
 
int(exp(2*tau - 2*t)*y(tau), tau, 0, t)
 
 
L =
 
laplace(y(t), t, s)/(s + 2)
 
 
L =
 
laplace(y(t), t, s)/(s + 2)
 
 
G =
 
laplace(y(t), t, s)
 
 
F =
 
1/(s + 2)
 
 
H =
 
laplace(y(t), t, s)/(s + 2)
 
</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Laplace Transform Lab: Solving ODEs using Laplace Transform in MATLAB
% This lab will teach you to solve ODEs using a built in MATLAB Laplace transform 
% function |laplace|.
% 
% There are five (5) exercises in this lab that are to be handed in. Write your 
% solutions in a separate file, including appropriate descriptions in each step.
% 
% Include your name and student number in the submitted file.
%% Student Information
%%
% 
%  Student Name: Patricia Nadia Krisanti
%
%%
% 
%  Student Number: 1009669404
%
%% Using symbolic variables to define functions
% In this exercise we will use symbolic variables and functions.

syms t s x y

f = cos(t)
h = exp(2*x)
%% Laplace transform and its inverse

% The routine |laplace| computes the Laplace transform of a function

F=laplace(f)
%% 
% By default it uses the variable |s| for the Laplace transform But we can specify 
% which variable we want:

H=laplace(h)
laplace(h,y)

% Observe that the results are identical: one in the variable |s| and the
% other in the variable |y|
%% 
% We can also specify which variable to use to compute the Laplace transform:

j = exp(x*t)
laplace(j)
laplace(j,x,s)

% By default, MATLAB assumes that the Laplace transform is to be computed
% using the variable |t|, unless we specify that we should use the variable
% |x|
%% 
% We can also use inline functions with |laplace|. When using inline functions, 
% we always have to specify the variable of the function.

l = @(t) t^2+t+1
laplace(l(t))
%% 
% MATLAB also has the routine |ilaplace| to compute the inverse Laplace transform

ilaplace(F)
ilaplace(H)
ilaplace(laplace(f))
%% 
% If |laplace| cannot compute the Laplace transform, it returns an unevaluated 
% call.

g = 1/sqrt(t^2+1)
G = laplace(g)
%% 
% But MATLAB "knows" that it is supposed to be a Laplace transform of a function. 
% So if we compute the inverse Laplace transform, we obtain the original function

ilaplace(G)
%% 
% The Laplace transform of a function is related to the Laplace transform of 
% its derivative:

syms g(t)
laplace(diff(g,t),t,s)
%% Exercise 1
% Objective: Compute the Laplace transform and use it to show that MATLAB 'knows' 
% some of its properties.
% 
% Details: 
% 
% (a) Define the function |f(t)=exp(2t)*t^3|, and compute its Laplace transform 
% |F(s)|. (b) Find a function |f(t)| such that its Laplace transform is  |(s - 
% 1)*(s - 2))/(s*(s + 2)*(s - 3)| (c) Show that MATLAB 'knows' that if |F(s)| 
% is the Laplace transform of  |f(t)|, then the Laplace transform of |exp(at)f(t)| 
% is |F(s-a)| 
% 
% (in your answer, explain part (c) using comments). 
% 
% Observe that MATLAB splits the rational function automatically when solving 
% the inverse Laplace transform.

%a
syms f(t) f2(t)
f(t)=exp(2.*t).*t.^3
F=laplace(f(t))
%b
f2(t)=((s - 1)*(s - 2))/(s*(s + 2)*(s - 3))
f=ilaplace(f2)

%c 
h = @(t) t^2
H1 = laplace(h(t))
H2 = laplace(exp(3*t) * h(t)) % is H1 with s shifted by 3 (s-3)
% it shows that MATLAB knows that the laplace transform of exp(at)f(t) is
% F(s-a) because it outputs the same value of s in H1 and replace it by
% (s-3) in H2 when the function is multiplied by exp(3t)
%% Heaviside and Dirac functions
% These two functions are builtin to MATLAB: |heaviside| is the Heaviside function 
% |u_0(t)| at |0|
% 
% To define |u_2(t)|, we need to write

f=heaviside(t-2)
ezplot(f,[-1,5])

% The Dirac delta function (at |0|) is also defined with the routine |dirac|

g = dirac(t-3)

% MATLAB "knows" how to compute the Laplace transform of these functions

laplace(f)
laplace(g)
%% Exercise 2
% Objective: Find a formula comparing the Laplace transform of a translation 
% of |f(t)| by |t-a| with the Laplace transform of |f(t)|
% 
% Details: 
%% 
% * Give a value to |a|
% * Let |G(s)| be the Laplace transform of |g(t)=u_a(t)f(t-a)| and |F(s)| is 
% the Laplace transform of |f(t)|, then find a formula relating |G(s)| and |F(s)|
%% 
% In your answer, explain the 'proof' using comments.

syms g(t) f(t)
a=5
u_a(t)=heaviside(t)
g(t)=u_a(t-a).*f(t-a)
G=laplace(g)
F=laplace(f)
%G(s) = exp(-as)*F
%when shifted by t-a (shift to the right by a), the laplace transform
%will also shift into the original laplace transform multiplied by exp(-as)
%this agrees with the property of laplace transform as proven in tutorial

%% Solving IVPs using Laplace transforms
% Consider the following IVP, |y''-3y = 5t| with the initial conditions |y(0)=1| 
% and |y'(0)=2|. We can use MATLAB to solve this problem using Laplace transforms:

% First we define the unknown function and its variable and the Laplace
% transform of the unknown

syms y(t) t Y s

% Then we define the ODE

ODE=diff(y(t),t,2)-3*y(t)-5*t == 0

% Now we compute the Laplace transform of the ODE.

L_ODE = laplace(ODE)

% Use the initial conditions

L_ODE=subs(L_ODE,y(0),1)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),2)

% We then need to factor out the Laplace transform of |y(t)|

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

% We now need to use the inverse Laplace transform to obtain the solution
% to the original IVP

y = ilaplace(Y)

% We can plot the solution

ezplot(y,[0,20])

% We can check that this is indeed the solution

diff(y,t,2)-3*y
%% Exercise 3
% Objective: Solve an IVP using the Laplace transform
% 
% Details: Explain your steps using comments
%% 
% * Solve the IVP
% * |y'''+2y''+y'+2*y=-cos(t)|
% * |y(0)=0|, |y'(0)=0|, and |y''(0)=0|
% * for |t| in |[0,10*pi]|
% * Is there an initial condition for which |y| remains bounded as |t| goes 
% to infinity? If so, find it.

syms y(t) t Y s 
% Then we define the ODE

ODE=diff(y(t),t,3)+2*diff(y(t),t,2)+diff(y(t),t,1)+2*y(t)+cos(t) == 0
%y'''+2y''+y'+2*y=-cos(t)

% Now we compute the Laplace transform of the ODE.

L_ODE = laplace(ODE)

% Use the initial conditions

L_ODE=subs(L_ODE,y(0),0)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),0)
L_ODE=subs(L_ODE,subs(diff(y(t), t, 2), t, 0),0)

% We then need to factor out the Laplace transform of |y(t)|

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

% We now need to use the inverse Laplace transform to obtain the solution
% to the original IVP

y = ilaplace(Y)

% We can plot the solution

ezplot(y,[0,10*pi])


% Using arbitrary constants a, b, and c we can find the general
% solution of the ODE
% a*exp(-2t) +bcos(t)+c*sin(t)-t*sin(t)/5+t*cos(t)/10
% There's no initial condition for which y remains bounded as t goes to
% infinity since when t approaches infinity y will continue growing while oscillating 
% -a*exp(-2t) will approach 0
% bcos(t) will oscillate will oscillate between b and -b
% c*sin(t) will oscillate between c and -c
% which means the final solution will oscillate
% - t*sin(t)/5 + t*cos(t)/10 will diverge, this does not depend on
% constants a, b, and c or the initial conditions
% thus the final solution will oscillate while diverge, or in other words
% growing while oscillating no matter the initial conditions
%% Exercise 4
% Objective: Solve an IVP using the Laplace transform
% 
% Details: 
%% 
% * Define 
% * |g(t) = 3 if 0 < t < 2|
% * |g(t) = t+1 if 2 < t < 5|
% * |g(t) = 5 if t > 5|
% * Solve the IVP
% * |y''+2y'+5y=g(t)|
% * |y(0)=2 and y'(0)=1|
% * Plot the solution for |t| in |[0,12]| and |y| in |[0,2.25]|.
%% 
% In your answer, explain your steps using comments.

% First we define the unknown function and its variable and the Laplace
% transform of the unknown

syms y(t) t Y s g(t)
%g(t) = piecewise(0 < t < 2, 3 , 2 < t < 5, t+1, t > 5, 5)
%g(t) = (3).*[heaviside(t)-heaviside(t-2)]+(t+1).*[heaviside(t-2)-heaviside(t-5)]+(5).*[heaviside(t-5)];
g(t) = (3).*(heaviside(t))+(t-2).*heaviside(t+3).*(heaviside(t-5));
%plot(t,y)
% Then we define the ODE

ODE=diff(y(t),t,2)+2.*diff(y(t),t) + 5*y(t) == g(t)

% Now we compute the Laplace transform of the ODE.

L_ODE = laplace(ODE)

% Use the initial conditions

L_ODE=subs(L_ODE,y(0),2)
L_ODE=subs(L_ODE,subs(diff(y(t), t), t, 0),1)

% We then need to factor out the Laplace transform of |y(t)|

L_ODE = subs(L_ODE,laplace(y(t), t, s), Y)
Y=solve(L_ODE,Y)

% We now need to use the inverse Laplace transform to obtain the solution
% to the original IVP

y = ilaplace(Y)

% We can plot the solution

ezplot(y,[0, 12, 0, 2.25])
clear
%% Exercise 5
% Objective: Use the Laplace transform to solve an integral equation
% 
% Verify that MATLAB knowns about the convolution theorem by explaining why 
% the following transform is computed correctly.

syms t tau y(tau) s
I=int(exp(-2*(t-tau))*y(tau),tau,0,t) %f(t-Tau) = exp(-2*(t-tau)) , g(tau)=y(tau)
L= laplace(I,t,s)
L= laplace(int(exp(-2*(tau))*y(t-tau),tau,0,t),t,s) %H

G=laplace(y(t), t, s)
F=laplace(exp(-2*(t)), t, s)
H=F*G
% as shown by the answer, the solution to the laplace of the integral of
% f(t-tau)g(tau) dtau is equivalent to the laplace of f(t) * laplace of g(t)
% which satisfies the convolution theorem that states that Laplace transform of a convolution integral is equal 
% to the product of the individual Laplace transforms of the functions involved.
##### SOURCE END #####
-->
</body>
</html>
